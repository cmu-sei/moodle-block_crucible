define("block_crucible/search",[],(function(){const $$=(root,sel)=>Array.from(root.querySelectorAll(sel)),$=(root,sel)=>root.querySelector(sel),norm=t=>(t||"").toString().trim().toLowerCase();function bindTemplate(root,cfg){const toolbarRoot=null!=cfg&&cfg.toolbar?document.querySelector(cfg.toolbar):root,searchInput=$(toolbarRoot,".lp-search"),clearBtn=$(toolbarRoot,".lp-clear"),resCountEl=$(toolbarRoot,".lp-result-count"),emptyEl=$(root,".lp-empty"),groupEls=$$(root,".cru-group"),compEls=$$(root,".cru-comp");if(!searchInput)return;const compIndex=new Map;function applyFilter(){const q=norm(searchInput.value);let visibleGroups=0,visibleComps=0,visibleCourses=0,visibleActivities=0;compEls.forEach((compEl=>{const blob=compIndex.get(compEl),compMatches=!q||blob.includes(q);let anyCourseVisible=!1;$$(compEl,".cru-course").forEach((courseEl=>{let courseVisible=!q;if(q){var _$6,_$7;const courseBlob=norm([courseEl.dataset.courseName,null===(_$6=$(courseEl,".cru-course-link"))||void 0===_$6?void 0:_$6.textContent,null===(_$7=$(courseEl,".cru-course-short"))||void 0===_$7?void 0:_$7.textContent].filter(Boolean).join(" "));let anyActVisible=!1;$$(courseEl,".cru-activity").forEach((actEl=>{const actVisible=norm(actEl.dataset.activityName).includes(q)||courseBlob.includes(q)||compMatches;actEl.style.display=actVisible?"":"none",actVisible&&(anyActVisible=!0,visibleActivities++)})),courseVisible=compMatches||courseBlob.includes(q)||anyActVisible}courseEl.style.display=courseVisible?"":"none",courseVisible&&(anyCourseVisible=!0,visibleCourses++)}));const compVisible=!q||compMatches||anyCourseVisible;compEl.style.display=compVisible?"":"none",compVisible&&visibleComps++,q&&(compEl.open=compVisible)})),groupEls.forEach((groupEl=>{const groupHasVisible=$$(groupEl,".cru-comp").some((c=>"none"!==c.style.display));groupEl.style.display=groupHasVisible?"":"none",q&&(groupEl.open=groupHasVisible),groupHasVisible&&visibleGroups++}));const hasAnyVisible=visibleComps>0&&visibleGroups>0;emptyEl&&(emptyEl.style.display=q&&!hasAnyVisible?"":"none"),resCountEl&&(q?(resCountEl.style.display="block",resCountEl.textContent="".concat(visibleComps," competenc").concat(1===visibleComps?"y":"ies",", ")+"".concat(visibleCourses," course").concat(1===visibleCourses?"":"s",", ")+"".concat(visibleActivities," activit").concat(1===visibleActivities?"y":"ies"," for “").concat(q,"”")):(resCountEl.style.display="none",resCountEl.textContent="")),clearBtn&&(clearBtn.style.display=q?"block":"none")}compEls.forEach((c=>compIndex.set(c,function(compEl){var _$,_$2,_$3;const parts=[];parts.push(compEl.dataset.compName,compEl.dataset.compFramework,compEl.dataset.compId);const title=null===(_$=$(compEl,".cru-comp-title"))||void 0===_$?void 0:_$.textContent,fw=null===(_$2=$(compEl,".cru-comp-framework"))||void 0===_$2?void 0:_$2.textContent,desc=null===(_$3=$(compEl,".cru-comp-desc"))||void 0===_$3?void 0:_$3.textContent;return parts.push(title,fw,desc),$$(compEl,".cru-course").forEach((courseEl=>{var _$4,_$5;parts.push(courseEl.dataset.courseName);const linkText=null===(_$4=$(courseEl,".cru-course-link"))||void 0===_$4?void 0:_$4.textContent,shortTxt=null===(_$5=$(courseEl,".cru-course-short"))||void 0===_$5?void 0:_$5.textContent;parts.push(linkText,shortTxt),$$(courseEl,".cru-activity").forEach((actEl=>{parts.push(actEl.dataset.activityName)}))})),norm(parts.filter(Boolean).join(" "))}(c)))),searchInput.addEventListener("input",applyFilter),clearBtn&&clearBtn.addEventListener("click",(()=>{searchInput.value="",applyFilter(),searchInput.focus()})),root.addEventListener("keydown",(evt=>{"/"===evt.key&&document.activeElement!==searchInput&&(evt.preventDefault(),searchInput.focus())})),applyFilter()}return{init:function(config){const selector="string"==typeof config?config:(null==config?void 0:config.root)||".lp-template",toolbar="object"==typeof config?config.toolbar:null;document.querySelectorAll(selector).forEach((root=>bindTemplate(root,{toolbar:toolbar})))}}}));

//# sourceMappingURL=search.min.js.map